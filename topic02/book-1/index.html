 <!DOCTYPE html>
 <html>
   <head>

     <meta charset="utf-8">
     <meta name="viewport" content="width=device-width, initial-scale=1">

     

     <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>

     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.4/semantic.min.css" type="text/css">
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/styles/solarized-light.min.css" rel="stylesheet" />

     <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
     <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.address/1.6/jquery.address.min.js"></script>
     <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.4/semantic.min.js"></script>
     <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/highlight.min.js"></script>
     <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/languages/java.min.js"></script>
     <script>hljs.initHighlightingOnLoad();</script>

     

     <style>
       

body 
{
  font-family: "Open Sans", "Helvetica", "Helvetica Neue",  "Arial", sans-serif;
}

figcaption
{
  margin-bottom: 20px;
}

.vertical-align
{
  display: flex;
  align-items: center;
}



     </style>

   </head>

  <body>
    

<style>
  

code
{
  font-family: "Monaco";
  font-size: 110%;
}

img
{
  padding:1px;
  border:1px solid black;
}

h1
{
  font-style:italic;
  font-size:130%;
  border-bottom:thin solid black;
}

h2
{
  font-size:110%;
  border-bottom: thin solid black;
}

h3
{
  font-size:100%;
  border-bottom: thin solid black;
}

body
{
  overflow-y: scroll;
}

.pushable > .pusher
{
  padding-bottom: 1.5rem;
}

.ui.segment.pushable
{
  margin: 0;
  padding: 1rem 0;
  overflow: visible;
}



</style>

<div class="ui fixed top pointing inverted stackable menu labmenu">
  <header class="header item">
    <i id="toc" class="sitemap icon"></i>
    <a href="../index.html">
      Introduction to Version Control and Node.js
    </a>
  </header>
  <div class="right tab-menu menu">
    
    <a class="item" data-tab="node_lab1">
      node_lab1
    </a>
    
    <a class="item" data-tab="01">
      01
    </a>
    
    <a class="item" data-tab="02">
      02
    </a>
    
    <a class="item" data-tab="03">
      03
    </a>
    
    <a class="item" data-tab="04">
      04
    </a>
    
    <a class="item" data-tab="05">
      05
    </a>
    
    <div class="item">
      
    </div>
  </div>
</div>

<div class="ui segment pushable" >

  <div class="ui inverted labeled icon left inline vertical sidebar menu">
    
      
        <a class="item" href="../../topic01/book-1/index.html">
          Lab-JavaScript-01
        </a>
      
    
      
        <a class="item" href="../../topic01/book-2/index.html">
          Lab-JavaScript-02
        </a>
      
    
      
        <a class="active item" href="../../topic02/book-1/index.html">
          node_lab1
        </a>
      
    
  </div>
  <div class="pusher" tabindex="-1">
    <div class="ui basic segment" id="labchat">
      <br>
      
      <div  class="ui tab segment lab" data-tab="node_lab1">
        <h2>Node and Express 1</h2>
<p>This lab introduces <strong>node.js</strong> as a server-side technology. Now we will use node.js to run javascript programs on the &quot;server-side&quot; which are capable of servicing HTTP requests.  In this lab you will learn how to:</p>
<ul>
<li>Create and use a remote repo on Github</li>
<li>Set node up as a HTTP server.</li>
<li>Use Node&#39;s built in http module to create a simple HTTP server.</li>
<li>Node&#39;s packaging system.</li>
<li>How to host your existing web resources in a Node.js HTTP server.</li>
<li>How to do a simple route for a HTTP request.</li>
</ul>

      </div>
     
      <div  class="ui tab segment lab" data-tab="01">
        <h1>Get Git</h1>
<p><img src="./img/git1.png" alt="git"></p>
<h3>Windows OS</h3>
<p>If you&#39;re on Windows, download the  <strong>GitHub Desktop</strong>, from <a href="https://desktop.github.com/">here</a> which includes Git, and use the Git Shell for your terminal.</p>
<h3>Mac</h3>
<p>You can install Git automatically. To do this, open the Terminal application from spotlight and type <code>git</code>. This will prompt Git to install the rest of the command line tools for Git. This should only take a few minutes. It will ask if you would like to download Xcode, which you can ignore.</p>
<h3>Linux</h3>
<p>You can use the package-management tool that comes with your distribution. For Fedora use:</p>
<pre><code class="lang-bash">$ sudo yum install git-all</code></pre>
<p>For Debian use:</p>
<pre><code class="lang-bash">$ sudo apt-get install git-all</code></pre>
<h2>Tell Git who you are</h2>
<p>You will to tell git who you are so that it can set an identity on all repos created and track changes. To set a global identity for all repos on the machine enter the following:</p>
<pre><code class="lang-bash">$ git config --global user.email &quot;your@email.com&quot;
$ git config --global user.name &quot;Your Name&quot;</code></pre>
<h2>Clone a Repository</h2>
<h3>Clone the samples repository</h3>
<p>Select a location on your machine where you would like to keep the code examples taken from the weekly talks. Open a terminal window in that location and clone the samples repository:</p>
<pre><code>git clone https://github.com/fxwalsh/node-dev-2018.git</code></pre>
<p>This should create a new folder called <em>node-dev-2018</em>. Open the folder and you should see the node samples from the lecture slides. We will use this repository for our example code as the module progresses. You will need to <em>pull</em> the repository each week to get the latest samples.</p>
<h2>Create a repository</h2>
<p>You can think of a repository as a project folder with all the related files inside of it.
<img src="./img/repos.png" alt="git repos">
You intialise a folder as a  Git repository and Git will start tracking the changes to that folder. Any files added, subtracted or changed are tracked and time stamped by Git. That&#39;s version control.</p>
<p>You&#39;re going to create a new folder and initialize it as a Git repository.
Make a new folder by opening a terminal window at the location where you want the examples on your machine. Enter the follwoing commands to make a new directory called <em>node-labs-2018</em> and then change directory into it :</p>
<pre><code class="lang-bash">$ mkdir node-labs-2018
$ cd node-labs-2018</code></pre>
<p>Now initialise the folder as a Git repo:</p>
<pre><code>$ git init</code></pre>
<p>To check that it&#39;s a Git repository, type <code>git status</code> and if returns something like &#39;On branch master ....&#39;, you&#39;ve got a new local repo!</p>
<h1>Add to the repository</h1>
<p>Open a text editor. Now write a couple of lines of text:</p>
<pre><code class="lang-text">#Node Development Practical Labs</code></pre>
<p>and save the file as readme.md in the <em>node-labs-2018</em> folder.</p>
<h3>Status, Add and Commit Changes</h3>
<p>Next check the status of your repository to find out if there have been changes. Below in this terminal, you should still be within the &#39;node-labs-2018&#39; you created. See if there are changes listed:</p>
<pre><code class="lang-bash">$ git status</code></pre>
<p>Then add the file you just created to the files you&#39;d like to commit (aka save) to change.</p>
<pre><code class="lang-bash">$ git add readme.md</code></pre>
<p>Finally, commit those changes to the repository&#39;s history with a short description of the updates.</p>
<pre><code class="lang-bash">$ git commit -m &quot;&lt;your commit message&gt;&quot;</code></pre>
<h3>Make More Changes</h3>
<p>Now add another line to <em>readme.md</em> and save.</p>
<p>In terminal, you can view the difference between the file now and how it was at your last commit.</p>
<pre><code class="lang-bash">$ git diff</code></pre>
<p>Now with what you just learned above, commit this latest change.</p>

      </div>
     
      <div  class="ui tab segment lab" data-tab="02">
        <h1>Github</h1>
<p>The repository you&#39;ve created so far is just on your computer, which is handy, but makes it pretty hard to share and work with others on.</p>
<h3>Create a GitHub Account</h3>
<p>GitHub is a website that allows people everywhere to upload what they&#39;re working on with Git and to easily work together.</p>
<p>Visit <a href="http://github.com">github.com</a> and sign up for a free account.</p>
<h3>Add username to Git</h3>
<p>Add your GitHub username to your Git configuration, which will be needed in order to verify the upcoming challenges. Save it exactly as you created it on GitHub â€” capitalise where capitalised, and remember you don&#39;t need to enter the &quot;&lt;&quot; and &quot;&gt;&quot; .</p>
<p>Add your GitHub username to your configuration:</p>
<pre><code class="lang-bash">$ git config --global user.username &lt;YOUR_GITHUB_USERNAME&gt;</code></pre>
<h2>Remote Repository</h2>
<p>When you put something on GitHub, that copy lives on one of GitHub&#39;s servers. This makes it a remote repository because it is not on your computer, but on a server, &quot;remote&quot; and somewhere else. By pushing your local (on your computer) changes to it, you keep it up to date.</p>
<p>Others can always get the latest from your project by pulling your changes down from the remote (and onto their computer). This is how everyone can work on a project together without needing access to your computer where your local copy is stored.</p>
<h3>Create a Remote Repository</h3>
<p>You want to sync your local version with one stored on GitHub.com called the remote version. So first create an empty remote repository on GitHub.com.</p>
<p>Go to github.com, log in, and click the &#39;+&#39; in the top right to create a new repository.
Give it a name that matches your local repository&#39;s name, <strong><em>node-labs-2018</em></strong>, and a short description.
Select the following options:
- make it public
- <em>don&#39;t</em> create a readme.md (you have one already in your local repo).
- create a .gitignore and select the <em>Node</em> option in the dropdown.
Click create repository and you should be taken to your new repo page. 
- Copy the URL from the browser address bar.  You will need the URL of the repo to connect your local repo to this &quot;remote&quot; repo.</p>
<h3>Connect your Local to your Remote</h3>
<p>Now you&#39;ve got a remote repository on GitHub.com, back in your terminal, and inside of the &#39;node-labs-2018&#39; folder that you initialised as a Git repository, you want to tell Git the location of the remote version on GitHub&#39;s servers. You can have multiple remotes so each requires a name. For your main one, this is commonly named <em>origin</em>.</p>
<pre><code class="lang-bash">$ git remote add origin &lt;Ugit RLFROMGITHUB&gt;</code></pre>
<p>Your local repository now knows where your remote one named &#39;origin&#39; lives on GitHub&#39;s servers. T</p>
<blockquote>
<p>   A note:</p>
<p>   If you have GitHub for Windows on your computer, a remote named &#39;origin&#39; is automatically created. In that case, you&#39;ll just need to tell it what URL to associate with origin. Use this command instead of the &#39;add&#39; one above:</p>
<p>   $ git remote set-url origin <URLFROMGITHUB></p>
</blockquote>
<h3>Pull down the changes on the remote repo</h3>
<p>You created a .gitignore file on the remote repo. You need to <em>pull</em> this change into your local repo. Git has a branching system so that you can work on different parts of a project at different times but by default the first branch is named &#39;master&#39;. When you pull (and push) from a project, you tell Git the branch name you want and the name of the remote that it lives on.
- Enter the following command to pull the remote changes into the master branch on your local repo:</p>
<pre><code class="lang-bash">$ git pull origin master</code></pre>
<ul>
<li>You will be required to edit a change file to justify the committing of remote changes to your local repo. Enter some text to describe the change and save the file.
Now we will <em>push</em> your local work (i.e. the readme.md) to the remote repo. </li>
</ul>
<h3>Push Work to your Remote</h3>
<p>Next you want to push (send) everything you&#39;ve done locally to GitHub. Ideally you want to stay in sync, meaning your local and remote versions match.</p>
<p>Similar to a pull, when you push from a project you tell Git the branch name you want to push and the name of the remote that it lives on.</p>
<p>In this case, we&#39;ll send our branch named &#39;master&#39; to our remote on GitHub named &#39;origin&#39;.</p>
<pre><code class="lang-bash">$ git push origin master</code></pre>
<p>Now go to GitHub and refresh the page of your repository. Everything is the same locally and remotely. You should see the following in your local repo:</p>
<p><img src="./img/git_repo_init.png" alt="Empty Local Repo"></p>
<p>Congrats on your first public repository! You will use this repository to contain the rest of your lab work.</p>

      </div>
     
      <div  class="ui tab segment lab" data-tab="03">
        <h1>Set Up and Configuration</h1>
<p>We will now set up and configure a development environment for Node.js.</p>
<h4>package.json</h4>
<p>If you&#39;re developing a Node program or library for deployment, it&#39;s a good practice to include a <strong>package.json</strong> file. This file is a manifest of the Node project and is located at your project root. It contains various information specific to your project.</p>
<ul>
<li>Create a new folder called <em>node_lab1</em> in your new repo.
<img src="./img/git_repo_lab1.png" alt="Empty Local Repo"></li>
<li>Open a terminal window in <em>node_lab1</em> and enter the following command:</li>
</ul>
<blockquote>
<pre><code class="lang-bash">npm init</code></pre>
</blockquote>
<p>You will be prompted for details.</p>
<ul>
<li>Enter the following:</li>
</ul>
<blockquote>
<pre><code class="lang-json">name: (lab1) node-lab1
version: (1.0.0) 
description: node lab 1
entry point: (index.js)
test command:
git repository: 
keywords:
author: YOUR_GIT_USERNAME
license: (ISC)</code></pre>
</blockquote>
<p>You should now see a <code>package.json</code> file in the lab folder with these details.</p>
<h4>Babel</h4>
<p>We will be writing our Javascript using ES2015 so we require transcoding before our Node app runs. We need to bring in some babel packages to handle this.</p>
<ul>
<li>Enter the following command to get the relevant babel package and relevant  presets.<pre><code class="lang-bash">npm install --save-dev babel-cli
npm install --save-dev babel-preset-env</code></pre>
</li>
</ul>
<p>The <code>--save-dev</code> will write this dependency to the development section of the package.json.</p>
<ul>
<li>To configure babel to transcode from es2015, create a file called <strong>.babelrc</strong> in the <strong>node-lab1</strong> folder and enter in the following:<pre><code class="lang-json">{
&quot;presets&quot;: [&quot;env&quot;]
}</code></pre>
Now have a look at the  <em>package.json</em> file. You&#39;ll see that the babel development dependencies are specified.  </li>
</ul>
<h4>Express</h4>
<p>To create a web server, we&#39;re going to use <strong>Express.js</strong> so we need to install this as a <strong>normal dependency</strong>.</p>
<ul>
<li>Install the express package.<pre><code class="lang-bash">npm install --save express</code></pre>
</li>
</ul>
<p>The --save flag will write this dependency to package.json.</p>
<h4>Nodemon</h4>
<p>When we change things in a Node.js project, a restart is required for the changes to be reflected in the running process. This can be very time consuming. Instead of manually restarting Node, we will install the <code>nodemon</code> package as a <strong>development dependency</strong>, which can monitor our files and auto-restart Node for us when we save changes to disk.</p>
<ul>
<li>Install Nodemon:<pre><code class="lang-bash">npm install --save-dev nodemon</code></pre>
</li>
</ul>
<h4>Startup Script</h4>
<p>We want to specify a script to start up the Node server, which will be the <strong>server.js</strong> file. So our start script would be <code>node server.js</code>. However, since we want the code to be transcoded using  babel and started with nodemon, we will add a <strong>nodemon</strong> execution wrapper and use <strong>babel-node</strong> instead of the node command.</p>
<ul>
<li>Modify the package.json file and replace the <em>scripts</em> property with the following:<pre><code class="lang-json">....
&quot;scripts&quot;: {
  &quot;start&quot;: &quot;nodemon --exec babel-node index.js&quot;
},
....</code></pre>
</li>
</ul>
<h4>Linting</h4>
<p>Finally, it&#39;d be nice to get feedback on the quality of your Javascript code as you write it. ESLint is a tool for identifying and reporting on patterns found in ECMAScript/JavaScript code. It kind of tells you if your code looks lousy! </p>
<ul>
<li><p>Install ESLint as follows:</p>
<pre><code class="lang-bash">npm install --save-dev eslint babel-eslint</code></pre>
</li>
<li><p>To configure ESLint, enter the following at the command line:</p>
<pre><code class="lang-bash">./node_modules/.bin/eslint --init</code></pre>
</li>
<li><p>Answer the resulting questions as follows:</p>
</li>
</ul>
<blockquote>
<p>How would you like to configure ESLint? Use a popular style guide</p>
<p>Which style guide do you want to follow? Google</p>
<p>What format do you want your config file to be in? JSON</p>
</blockquote>
<p>You should now see a file called <em>.eslintrc.json</em> in the <em>node-lab1</em> folder.</p>
<ul>
<li>Open <em>.eslintrc.json</em> and replace the contents with the following<pre><code class="lang-json">{
  &quot;extends&quot;: &quot;google&quot;,
  &quot;parserOptions&quot;: {
      &quot;ecmaVersion&quot;: 6,
      &quot;sourceType&quot;: &quot;module&quot;
  },
  &quot;env&quot;: {
      &quot;node&quot;: true
  }
}</code></pre>
This specifies that we wish to lint ES6 Javascript in module format (uses imports and exports). We also specify the environment is Node.js with associated global variables and Node.js scoping. 
You&#39;ve now set your project folder up for linting your Javascript files.</li>
</ul>
<h4>App Config</h4>
<p>As discussed in class, one of the advantages of NPM is the wide availability of handy utility packages that follow accepted best practice. App configuration management and environment variables are common to many apps. When using public, cloud based repos you should use best practice approaches to keep sensitive parameters such as private keys and passwords safe.  </p>
<p>Dotenv is a zero-dependency module that loads environment variables from a .env file into <em>process.env</em>. In doing this Dotenv stores configuration in the environment separate from code is based on &quot;The Twelve-Factor App&quot; methodology.
This simple application just needs some typical configuration details, for example the port and host info.</p>
<ul>
<li><p>Install Dotenv as a normal, runtime dependency</p>
<pre><code class="lang-bash">npm install dotenv --save</code></pre>
</li>
<li><p>Create a new file in your application root folder called <strong>.env</strong> and add the following content:</p>
<pre><code class="lang-javascript">NODE_ENV=development
PORT=8080
HOST=localhost</code></pre>
</li>
</ul>
<p>As you could be putting sensitive stuff in the .env file, you should NOT commit your .env file to version control. It should only include environment-specific values such as database passwords or API keys used by your server-side API. Also, your production database should have a different password than your development database.</p>
<p>To ensure this is the case, do the following:</p>
<ul>
<li>Open <em>.gitignore</em> file in you <em>node-labs-2018</em> folder. Check that it contains the following entry:<pre><code class="lang-json"># dotenv environment variables file
.env</code></pre>
</li>
</ul>
<h4>Commit it</h4>
<p>Your <em>node-lab1</em> folder should look like this:
<img src="./img/git_repo_lab1_config.png" alt="node_lab1 folder"></p>
<p>Now that we have a our basic setup and configuration complete,this is a good time to commit your changes to git.</p>
<ul>
<li>As in previous labs, change directory to the ewd_labs_2018 folder and do the following:<pre><code class="lang-bash">git add -A
git commit -m &quot;set up and initial configuration&quot;</code></pre>
</li>
</ul>
<p>You should <strong>NOT</strong> see any output indicating changes ignored file and folders, for example the <em>node_modules</em> folder or <em>.env</em>.We do not need to track changes here as it&#39;s contents are specified in the <em>package.json</em>.</p>

      </div>
     
      <div  class="ui tab segment lab" data-tab="04">
        <h1>The &quot;Hello World&quot; HTTP Server</h1>
<p>We will be using node as a web application platform. In this step we&#39;ll set up a simple HTTP server that responds to every request with the plain text message &quot;Hello World&quot;.</p>
<ul>
<li>In the <em>node-lab1</em> create a new file called  <em>index.js</em>  with the following contents:</li>
</ul>
<pre><code class="lang-javascript">
// Load the http module to create an http server.
import http from &#39;http&#39;;
import dotenv from &#39;dotenv&#39;

dotenv.config()

const port = process.env.PORT
// Configure our HTTP server to respond with Hello World to all requests.
const server = http.createServer((req, res) =&gt; {
  res.writeHead(200, {&#39;Content-Type&#39;: &#39;text/plain&#39;});
  res.end(&#39;Hello  World!&#39;);
});

server.listen(port);

// Put a friendly message on the terminal
console.log(`Server running at ${port}`);</code></pre>
<p>In the first line, we import the http core module and assign it to <code>http</code>. Next we assign the variable  <code>server</code> from the <code>http.createServer(...)</code> function. The argument passed into this call is the function that is called whenever an http request comes in.
Finally we call <code>server.listen(config.port)</code> to tell node.js the port on which we want our server to run.
To run the server open a terminal/command window in the node-lab1 folder and enter:</p>
<pre><code>npm start</code></pre>
<p>Now open your browser to &#39;<a href="http://localhost:8080">http://localhost:8080</a>&#39;. You should see the following:
<img src="./img/hello_world.png" alt="Node Hello World"></p>
<p>The connection function is invoked with a <strong>req</strong> and <strong>res</strong> object. The <strong>req</strong> object represents the HTTP request and is a readable stream that emits &#39;data&#39; events for each incoming piece of data (like a form submission or file upload). The <strong><em>res</em></strong> object represents the HTTP response and is used to send data back to the client. In our case we are simply sending a 200 OK header, as well as the body &#39;Hello World&#39;.</p>
<h3>How bad?</h3>
<p>Now lets check how bad your code using ESLint.</p>
<ul>
<li>Run the following command to lint your code:<pre><code class="lang-bash">./node_modules/.bin/eslint index.js</code></pre>
The Google style guide requires each statement end with a semicolon. The linter should highlight this and you should see the following output:
<img src="./img/linter.png" alt="Node Hello World">
You can fix manually or use the command <code>./node_modules/.bin/eslint index.js --fix</code> to resolve the problems(if the linter suggests it).
When the code is in good order, the linter should return nothing. Nice code!</li>
</ul>
<h3>Node&#39;s Module System</h3>
<p>Node.js provides a simple module system that lets you structure your program into different files. In our <em>index.js</em> example, we use the core http module to create our HTTP service. You can also write your own modules. When creating a module, this can be interpreted as moving all related functions into a file.</p>
<ul>
<li>Create a new file called &#39;greeting.js&#39; in the same folder with the following content:  </li>
</ul>
<pre><code class="lang-javascript">const greeting = {
    en: &quot;Hello World!&quot;,
    fr: &quot;Bonjour!&quot;
}

export default greeting;</code></pre>
<ul>
<li>Update your <em>index.js</em> file as follows:</li>
</ul>
<pre><code class="lang-javascript">// Load the http module to create an http server.
import http from &#39;http&#39;;
import dotenv from &#39;dotenv&#39;;
import greeting from &#39;./greeting.js&#39;;

dotenv.config();
const port = process.env.PORT;

// Configure our HTTP server to respond with Hello World to all requests.
const server = http.createServer((req, res) =&gt; {
  let lang = req.headers[&#39;accept-language&#39;];
  const defaultLang=&#39;en&#39;;
  if (!greeting[lang]) lang=defaultLang;
  const response={
    lang: lang,
    message: greeting[lang],
  };

  res.writeHead(200, {&#39;Content-Type&#39;: &#39;text/plain&#39;,
                      &#39;Content-Language&#39;: response.lang});
  res.end(response.message);
});

server.listen(port);

// Put a friendly message on the terminal
console.log(`Server running at ${port}`);</code></pre>
<p>Now test your file again using a browser. The <code>export</code> expose greeting to other modules that require them. To access the exported functions in our simple server, we can load the greeting module using the require function in <code>import greeting from (&#39;./greeting&#39;);</code>. The server gets the accepted language from the requesting process using <code>req.headers[&quot;accept-language&quot;]</code> . To set the accept-language HTTP header of the request:</p>
<ul>
<li>install a suitable REST client. This lab will opt for <a href="https://www.getpostman.com/">Postman</a>.</li>
<li>Perform a <strong>HTTP GET</strong> request to <strong>localhost:8080</strong> with <code>Accept-language=fr</code>.</li>
</ul>
<p>You should see the french representation for the greeting returned in the response.</p>
<blockquote>
<p><img src="./img/greeting_in_french.png" alt="Greeting in French"></p>
</blockquote>
<p>As you will see, the core modules give you very few modules. Most of the real power in Node.js is contained in the third party modules available through the Node Package Management system(NPM).</p>
<h3>Commit your changes</h3>
<ul>
<li>Commit the changes you have just made using git.<pre><code class="lang-bash">git add -A
git commit -m &quot;node-lab1,  simple server&quot;</code></pre>
</li>
</ul>

      </div>
     
      <div  class="ui tab segment lab" data-tab="05">
        <h1>Express Applications</h1>
<p>We&#39;ll now add some static content to our web server. Up to now you&#39;ve used <strong>http-server</strong> which is fine for prototyping HTML. We&#39;ll now move to Express, the package we installed in the last section. Express is a richer web app package and provides a nice high level approach to serving up static content. It&#39;s based around the idea of creating an Express &quot;app&quot; that you can easily configure. One of the configuration options allows you to specify the location of your publicly available content such as static HTML, CSS, client-side Javascript files etc.</p>
<ul>
<li>In your <em>node-lab-1</em> folder, create the following folder structure:<pre><code>+public
  |-javascript
  |-stylesheets</code></pre>
</li>
<li>Get the solution to the <a href="./files/static.zip"><em>html/css lab</em></a> and place the files directly into the <em>public</em> folder(the <em>index.hmtl</em> file should in the <em>public</em> folder).</li>
<li>In node-lab-1, replace the contents of <strong>index.js</strong> with the following javascript:</li>
</ul>
<pre><code class="lang-javascript">
import dotenv from &#39;dotenv&#39;;
import express from &#39;express&#39;;

dotenv.config();

const server = express();

const port = process.env.PORT;

server.use(express.static(&#39;public&#39;));

server.listen(port, () =&gt; {
  console.info(`Server running at ${port}`);
});</code></pre>
<ul>
<li>Now test the application as before in a browser. It should display the default resource (index.html) from the public folder.</li>
</ul>
<h4>Simple Routing using Express</h4>
<p>Express gives us an easy way of mapping specific URL paths to Javascript functions. You will now replicate the functionality from the &quot;Hello World&quot; section so that a HTTP GET request for the URL path  &#39;/greeting/&#39; will respond with &quot;Hello World&quot;. Modify the index.js by adding an <code>app.get([route],[callback function])</code>.
- Modify the index.js script to include a route for /greeting that responds with &quot;hello world&quot;.</p>
<pre><code class="lang-javascript">import dotenv from &#39;dotenv&#39;;
import express from &#39;express&#39;;
import greeting from &#39;./greeting&#39;;

dotenv.config();

const app = express();

const port = process.env.PORT;

app.use(express.static(&#39;public&#39;));

// add route for /greeting
app.get(&#39;/greeting&#39;, (req, res)=&gt;{
  let lang = req.headers[&#39;accept-language&#39;];
  const defaultLang=&#39;en&#39;;
  if (!greeting[lang]) lang=defaultLang;
  const response={
    lang: lang,
    message: greeting[lang],
  };

  res.writeHead(200, {&#39;Content-Type&#39;: &#39;text/plain&#39;,
                      &#39;Content-Language&#39;: response.lang});
  res.end(response.message);
});


app.listen(port, () =&gt; {
  console.info(`Server running at ${port}`);
});</code></pre>
<h3>Commit and Push to Github</h3>
<p>Commit your changes using git as before and push your changes to your remote repository.</p>
<pre><code class="lang-script">git add -A
git commit -m &quot;Changed to express app&quot;
git push origin master</code></pre>
<h3>Contacts API</h3>
<p> Ultimately we would like our API to use a datav=base such as Mongo and allow for a more realistic API that can cope with large volumes of data you would expect in a production environment.</p>
<p>Create a new folder called <strong>api</strong> in <strong>node-lab-1</strong>. Create another folder called <strong>contacts</strong> in <strong>api</strong>. Your folder structure should look as follows:</p>
<pre><code>+node-lab-1
    |-api
       |-contacts</code></pre>
<p>We will use test data for the time being. </p>
<ul>
<li>Create a new file called <strong>contacts.js</strong> in the contacts folder and add the following code:</li>
</ul>
<pre><code class="lang-javascript">export const contacts = [
  {
    &#39;name&#39;: &#39;Contact 1&#39;,
    &#39;address&#39;: &#39;123 Test St&#39;,
    &#39;phone_number&#39;: &#39;132-3212&#39;,
  },
  {
    &#39;name&#39;: &#39;Contact 2&#39;,
    &#39;address&#39;: &#39;23 Main St&#39;,
    &#39;phone_number&#39;: &#39;934-4329&#39;,
  },
  {
    &#39;name&#39;: &#39;Contact 3&#39;,
    &#39;address&#39;: &#39;4 Lower St&#39;,
    &#39;phone_number&#39;: &#39;432-5832&#39;,
  },
  {
    &#39;name&#39;: &#39;Contact 4&#39;,
    &#39;address&#39;: &#39;49 Upper Street&#39;,
    &#39;phone_number&#39;: &#39;934-4290&#39;,
  },
];</code></pre>
<ul>
<li>Also in the contacts folder, create a new file called <strong>index.js</strong> and enter the folowing javascript:</li>
</ul>
<pre><code class="lang-javascript">import express from &#39;express&#39;;
import {contacts} from &#39;./contacts&#39;;

const router = express.Router(); // eslint-disable-line
router.get(&#39;/&#39;, (req, res) =&gt; {
  res.send({contacts: contacts});
});

export default router;</code></pre>
<ul>
<li>Now update <strong>index.js</strong> to use the new contacts routing script by replacing the contents with the following code</li>
</ul>
<pre><code class="lang-javascript">import config from &#39;./config&#39;;
import express from &#39;express&#39;;
import contactsRouter from &#39;./api/contacts&#39;;

const server = express();

server.use(&#39;/api/contacts&#39;, contactsRouter);
server.use(express.static(&#39;public&#39;));

server.listen(config.port, config.host, () =&gt; {
  console.info(&#39;Express listening on port&#39;, config.port);
});</code></pre>
<p>Now test the application again by doing a HTTP GET on localhost/api/contacts. You should see something simlilar toe the following:</p>
<p><img src="./img/contacts_api_1.png" alt="Get contact details"></p>
<h3>Challange</h3>
<ul>
<li>Try to include in server-side route for the Hacker News lab you did last week. Follow the same procedure as above.</li>
</ul>
<blockquote>
<p>hint: create a new folder in api for Hacker News. Create a routing script and update index.js to add the Hacker News route.</p>
</blockquote>

      </div>
     
    </div>

  </div>

</div>
<!--  <div class="ui bottom fixed borderless right menu">
    <div class="ui right tiny menu">
      <div class="ui mini message segment">
        Frank Walsh (fxwalsh@wit.ie).
        <a  href="http://creativecommons.org/licenses/by-nc/4.0/" title="External link to http://creativecommons.org/licenses/by-nc/4.0/"
            target="_blank">Creative Commons License
        </a>
      </div>
    </div>
  </div>-->

<script>
  $(document).on('keydown', function (e) {
  e = e || window.event;
  var nextTab;
  switch (e.which || e.keyCode) {
    case 37: // left
      nextTab = $('.tab-menu a[data-tab].active').prev('a[data-tab]');
      if (!nextTab.length) nextTab = $('.tab-menu a[data-tab]').last();
      nextTab.click();
      $('.pusher').focus();
      break;

    case 39: // right
      nextTab = $('.tab-menu a[data-tab].active').next('a[data-tab]');
      if (!nextTab.length) nextTab = $('.tab-menu a[data-tab]').first();
      nextTab.click();
      $('.pusher').focus();
      break;
  }
});

</script>



    <footer>

    </footer>
    <script>
      $(document).ready(function () {
  $('img').addClass('ui image');
  $('.ui.embed').embed();

  const $images = $('.lab img');
  jQuery.each($images, function (i) {
    if (($images[i].alt).length > 0) {
      const divImg = $(document.createElement('div')).addClass('ui basic segment');
      $($images[i]).wrap(divImg);
      const divLabel = $(document.createElement('div')).addClass('ui blue ribbon label');
      divLabel.append($images[i].alt);
      $(divLabel).insertBefore($images[i]);
    }
  });

  $('.ui.embed').embed();

  $('.ui.menu .item')
      .tab({
        history: true,
        historyType: 'hash',
      });

  $('.popup').popup();

  $('.ui.sidebar')
      .sidebar({ context: $('.pushable') })
      .sidebar('setting', 'transition', 'slide out')
      .sidebar('attach events', '#toc');
});

    </script>
  </body>

 </html>