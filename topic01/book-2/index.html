<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.10/semantic.min.css" type="text/css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-light.min.css" rel="stylesheet" />
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.address/1.6/jquery.address.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.10/semantic.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/java.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <style>
      

body
{
  font-family: "Open Sans", "Helvetica", "Helvetica Neue",  "Arial", sans-serif;
}

figcaption
{
  margin-bottom: 20px;
}

.vertical-align
{
  display: flex;
  align-items: center;
}

.ui.segment.pushable
{
  margin: 0;
  padding: 1rem 0;
  overflow: visible;
}

code
{
  font-family: "Monaco";
  font-size: 110%;
}

img
{
  padding:1px;
  border:1px solid black;
}

h1
{
  font-style:italic;
  font-size:130%;
  border-bottom:thin solid black;
}

h2
{
  font-size:110%;
  border-bottom: thin solid black;
}

h3
{
  font-size:100%;
  border-bottom: thin solid black;
}

body
{
  overflow-y: scroll;
}

.pushable > .pusher
{
  padding-bottom: 1.5rem;
}

.ui.segment.pushable
{
  margin: 0;
  padding: 1rem 0;
  overflow: visible;
}



    </style>
  </head>

  <body>
    
    

    <div class="ui fixed top pointing inverted stackable menu labmenu">
      <header class="header item">
        <i id="toc" class="sitemap icon"></i>
        <a href="../index.html">
          Introduction to Web Services 
        </a>
      </header>
      <div class="right tab-menu menu">
        
          <a class="item" data-tab="Lab-JavaScript-02">
            Lab-JavaScript-02
          </a>
        
          <a class="item" data-tab="01">
            01
          </a>
        
          <a class="item" data-tab="02">
            02
          </a>
        
          <a class="item" data-tab="03">
            03
          </a>
        
        <div class="item">
          
        </div>
      </div>
    </div>

    <div class="ui segment pushable">
      <div class="ui inverted labeled icon left inline vertical sidebar menu">
        <br><br>
        
          
            <a class="item" href="../../topic01/book-1/index.html">
              Lab-JavaScript-01
            </a>
          
        
          
            <a class="active item" href="../../topic01/book-2/index.html">
              Lab-JavaScript-02
            </a>
          
        
          
            <a class="item" href="../../topic02/book-1/index.html">
              node_lab1
            </a>
          
        
          
            <a class="item" href="../../topic03/book-1/index.html">
              node_lab2
            </a>
          
        
          
            <a class="item" href="../../topic03/book-2/index.html">
              Assignment-1
            </a>
          
        
          
            <a class="item" href="../../topic04/book1/index.html">
              node-lab3
            </a>
          
        
          
            <a class="item" href="../../topic05/book-1/index.html">
              Lab-PubSub-01
            </a>
          
        
          
            <a class="item" href="../../topic06/book-1/index.html">
              api-testing-ES6
            </a>
          
        
      </div>
      <div class="pusher" tabindex="-1">
        <div class="ui basic segment" id="labchat">
          <br>
          
            <div  class="ui tab segment lab" data-tab="Lab-JavaScript-02">
              <h1>Javascript Introduction</h1>
<p>The main aim of this lab is to prepare you for working with Node.js. The lab will focus on the behaviour constructs of JS, specifically, <strong>functions, methods and constructors</strong>.</p>

            </div>
          
            <div  class="ui tab segment lab" data-tab="01">
              <h1>Node.js</h1>
<p>If you do not have Node.js installed in you machine, please go to <a href="http://nodejs.org/">nodejs.org</a> and download/install node for your platform. To check if node is working, open a command line/terminal window on your machine and enter <code>node -v</code>. IT should respond as follows:</p>
<pre><code>&gt; node -v
v8.4.0</code></pre>
<p>The work for this lab has been tested with node version 0.13.0. </p>

            </div>
          
            <div  class="ui tab segment lab" data-tab="02">
              <h1>Javascript (JS) Functions.</h1>
<p>The related sample code accompanying the Javascript lecture slides (available <a href="./javascript-lab_files/functions.js">here</a>) should be used as a guide to implementing the exercises for this lab.</p>
<h2>Start.</h2>
<p>Use <a href="./javascript-lab_files/lab_functions.js">this JS code</a> as the starting point for this lab exercise. Open the downloaded file and examine its initial content.</p>
<h2>Functions.</h2>
<p>[In the sample code provided with the lecture slides (functions.js), review the section demonstrating <em>function declarations, variable scopes and function expressions</em>. ]</p>
<p>Suppose we want a function that adds an entry to the <em>previous_owners</em> property of <em>aCar</em>. Add the following function expression statement to the end of <code>lab_functions.js</code>:</p>
<pre><code>    var addPreviousOwner = function(car,p_name,p_address) {
           var o = { name : p_name, address : p_address }
           car.previous_owners.push(o)
     }</code></pre>
<p>Recall, the <em>push</em> function adds the new entry to the end of the array. To prove this code works, add the following statements after the function expression:</p>
<pre><code>    addPreviousOwner(aCar,&#39;Jim Nugent&#39;,&#39;3 Lower Road&#39;)
    console.log(aCar.previous_owners[aCar.previous_owners.length - 1].name)</code></pre>
<p>The ‘console.log’ statement accesses the last entry in the <em>previous_owners</em> array - at index ‘length - 1’. Now run the code:</p>
<pre><code>     $ node lab_functions.js</code></pre>
<p>Let’s assume we decide to keep a record of only the three most recent previous owners of a car. When we try to add a fourth person then the first owner should be removed from the record, leaving the second owner as the first entry in the array. A similar procedure should be applied when we add a fifth and subsequent previous owner - the array never has more than three entries. You are required to change the implementation of the <em>addPreviousOwner</em> function to meet this requirement. To test your solution, add the following to the end of the <code>`lab_functions.js</code> file:</p>
<pre><code>     addPreviousOwner(aCar,&#39;Rachel Fleming&#39;,&#39;4 Upper Road&#39;)
     console.log(aCar.previous_owners[2].name)
     console.log(aCar.previous_owners[0].name)</code></pre>
<p>The two log statements should display the names Rachel Fleming and Sheila Dwyer.</p>
<p><a href="./javascript-lab_files/solution.html">See [Solution 01</a> for the completed code.]</p>
<h2>Variable scopes.</h2>
<p>In the <em>addPreviousOwner</em> function above it was not necessary to have <em>aCar</em> as an argument since this variable has <strong>global scope</strong>. Therefore the function expression could be reduced to:</p>
<pre><code>    var addPreviousOwner = function(p_name,p_address) { ... body ... }</code></pre>
<p>and in the body of the function all references to <em>car</em> should be changed to <em>aCar</em>.</p>
<p>[However, in general it is considered good practice to have functions independent of global scope. This enhances the function’s re-usability.]</p>
<p>The variable <em>o</em> declared inside the function is not accessible in global scope. To prove this, add the following log statement to the end of the file:</p>
<pre><code>   console.log(o.name)</code></pre>
<p>and run the code. An error is thrown to indicate o is not defined. Remove the log statement again to get rid of the error.</p>
<h2>Methods.</h2>
<p>[In the sample code provided with the lecture slides, review the section demonstrating <em>methods</em>.]</p>
<p>The <em>addPreviousOwner</em> function above should really be a method of <em>aCar</em>. To achieve this, make the following addition to <em>aCar</em>:</p>
<pre><code>    var aCar = {
        . . . . . . . 
        addPreviousOwner : function(p_name,p_address) {
               var o = { name : p_name, address : p_address }
               if (this.previous_owners.length == 3) {
                  this.previous_owners.shift()
               }
               this.previous_owners.push(o)
            },
        previous_owners : [ { name : &#39;Pat Smith&#39;, address : &#39;1 Main Street&#39;}, 
                            { name : &#39;Sheila Dwyer&#39;, address : &#39;2 High Street&#39;}],
        . . . . . . . .
    }</code></pre>
<p>Note, the keyword ‘this’ is used inside the method to reference the containing object (aCar). We should now remove the old <em>addPreviousOwner</em> function expression and replace all calls to that function with method calls instead. The method calls will be as follows:</p>
<pre><code>     aCar.addPreviousOwner(&#39;Jim Nugent&#39;,&#39;3 Lower Road&#39;)
     aCar.addPreviousOwner(&#39;Rachel Fleming&#39;,&#39;4 Upper Road&#39;)</code></pre>
<p>You are required to add another method to <em>aCar</em>, called <em>newOwner</em>. This method changes the owner details and adds the current owner to the list of previous owners. Test your method implementation by adding the following statements to the end of the file:</p>
<pre><code>    aCar.newOwner(&#39;Donal Dunne&#39;,&#39;5 Kings Way&#39;)
    console.log(aCar.previous_owners[2].name)
    console.log(aCar.owner)</code></pre>
<p>The log statements should display the names Joe Bloggs and Donal Dunne. [Hint: A method of an object can call another method (of the same object). Simply prefix the called method with <em>this</em>, e.g. this.otherMethod(. . . )]</p>
<p><a href="./javascript-lab_files/solution.html">See [Solution 02</a> for the completed code.]</p>
<h2>Methods/Function return.</h2>
<p>[First examine the relevant section of the sample code from the lecture and then continue.]</p>
<p>Add the following method to the car object:</p>
<pre><code>    var aCar = {
        . . . . . . . .
        howOld : function() {
               var today = new Date()
               var this_year = today.getFullYear()
               return this_year - (this.registration.year + 2000)
            },
        . . . . . . . . . 
    }</code></pre>
<p>It computes how old the car is, in years. To test it, add the following log statement to the end of the file:</p>
<pre><code>    console.log(aCar.howOld())</code></pre>
<p>and run it:</p>
<pre><code>     $ node lab_functions.js</code></pre>
<p>[The Date feature used in the above method is interesting. You can experiment with it in the Google Chrome Developer tools console, as illustrated below:</p>
<p><img src="./javascript-lab_files/date.png" alt=""></p>
<p>For some method a boolean (true/false) is the appropriate return value. For example, a method that determines whether a car has a certain feature (yes/no) would look as follows:</p>
<pre><code>    var aCar = {
        . . . . . 
        addPreviousOwner : function(p_name,p_address) { 
            . . . . . 
            },
        hasFeature : function(feature_in) {
            var result = false
            this.features.forEach(function(feature) {
            if (feature_in.toUpperCase() == feature.toUpperCase() ) {
               result = true
               }
            })
            return result
            },
        . . . . . . 
    }</code></pre>
<p>[For maximum user convenience, the method is made case-insensitive by temporarily converting everything to upper-case.]</p>
<p>To test this method, add the following to the bottom of the file:</p>
<pre><code>    console.log(&#39;Alarm :&#39; + aCar.hasFeature(&#39;alarm&#39;) )</code></pre>
<p>and run the code.</p>
<p>You are required to implement a method that determines if a particular person (name) was a previous owner of the car. To test your implementation add the following to the end of the file:</p>
<pre><code>     var name = &#39;Jim Nugent&#39;
     console.log(name + &#39; ? &#39; + aCar.wasOwnedBy(name))
     name = &#39;Paul Minihan&#39;
     console.log(name + &#39; ? &#39; + aCar.wasOwnedBy(name))</code></pre>
<p>The result should be:</p>
<pre><code>    Jim Nugent ? true
    Paul Minihan ? false</code></pre>
<p><a href="./javascript-lab_files/solution.html">See [Solution 03</a> for the completed code.]</p>
<h2>Constructors.</h2>
<p>Instead of using the literal syntax for creating the car object above, a constructor could be utilized - instantiating other car objects would be much easier as a consequence. For convenience, we will use a separate file, called <code>constructor.js</code> for the remainder of the lab. Create the file and paste in the following code:</p>
<pre><code>    function Car(name_in,address_in,make_in,model_in,cc_in) {
        this.owner = name_in
        this.address = address_in
        this.previous_owners = [ ]
        this.type = { make : make_in, model : model_in, cc : cc_in }
        this.addPreviousOwner = function(p_name,p_address) {
               var o = { name : p_name, address : p_address }
               if (this.previous_owners.length == 3) {
                  this.previous_owners.shift()
               }
               this.previous_owners.push(o)
            }
        this.wasOwnedBy = function(name_in) {
            var result = false
            this.previous_owners.forEach(function(owner) {
            var name = owner.name.toUpperCase()
            if (name_in.toUpperCase() == name) {
               result = true
               }
            })
            return result
            }
    }

    var car1 = new Car(&#39;Joe Bloggs&#39;,&#39;3 Walkers Lane&#39;,&#39;Toyota&#39;,&#39;Corolla&#39;,1.8)
    car1.addPreviousOwner( &#39;Pat Smith&#39;, &#39;1 Main Street&#39;)
    car1.addPreviousOwner( &#39;Pat Smith&#39;, &#39;1 Main Street&#39;)
    car1.addPreviousOwner( &#39;Sheila Dwyer&#39;, &#39;2 High Street&#39;)
    console.log(&#39;Path Smith ? &#39; + car1.wasOwnedBy(&#39;Pat Smith&#39;))</code></pre>
<p>[Note, this code is not yet complete.] Take some time to study it and then run it:</p>
<pre><code>    $ node constructor.js </code></pre>
<p>In the original <em>aCar</em> object we had a <em>newOwner</em> method. You are required to add this method to the <em>Car</em> constructor and then test your solution by adding the following to the end of the <code>constructor.js</code> file:</p>
<pre><code>    car1.newOwner(&#39;Donal Dunne&#39;,&#39;5 Kings Way&#39;)
    console.log(car1.previous_owners[2].name)
    console.log(car1.owner)</code></pre>
<p>The log statements should display Joe Bloggs and Donal Dunne.</p>
<p><a href="./javascript-lab_files/solution.html">See [Solution 04</a> for the completed code.]</p>
<p>The car registration details are not yet supported by our constructor. While this information is stored internally in a nested object, we don’t need to expose this to the constructor user. Using a simple string as the constructor parameter seems more natural, e.g. Car (….,‘10-WD-1058’). To satisfy this requirement our constructor must parse the registration string and place the elements in the nested object. JS has a special string method called <em>split</em> for parsing strings. You can experiment with it in Chrome’s Developer Tools console, as illustrated below:
<img src="./javascript-lab_files/split.png" alt="">
The <em>split</em> methods segments a string based on a given character, ’-’ in the above example. The methods returns an array containing the segments.</p>
<p>Now update the car constructor to make use of this feature, as follows:</p>
<pre><code>    function Car(name_in,address_in,make_in,model_in,cc_in,reg_in) {
        . . . . . 
        this.type = { make : make_in, model : model_in, cc : cc_in }
        var reg_parts = reg_in.split(&#39;-&#39;)
        var year = parseInt(reg_parts[0])
        this.registration = {year : year , 
                             county : reg_parts[1], 
                             number : reg_parts[2] }
        this.newOwner = function(p_name,p_address) { . . . }
        . . . . . . 
    }</code></pre>
<p>[The parseInt() function converts a numeric string to an integer, e.g. ‘123’ to 123. Experiment with it in Chrome’s Developer Tools console.]</p>
<p>You must now change the existing line of code that creates a car object to the following:</p>
<pre><code>    var car1 = new Car(&#39;Joe Bloggs&#39;,&#39;3 Walkers Lane&#39;,
                       &#39;Toyota&#39;,&#39;Corolla&#39;,1.8,&#39;10-WD-1058&#39;)</code></pre>
<p>To prove it all works, add the <em>howOld</em> method, as follows:</p>
<pre><code>    function Car(name_in,address_in,make_in,model_in,cc_in,reg_in) {
        . . . . . 
        this.howOld = function() {
               var today = new Date()
               var this_year = today.getFullYear()
               return this_year - (this.registration.year + 2000)
            }
        this.newOwner = function(p_name,p_address) { . . . }
        . . . . . 
    }</code></pre>
<p>and add this line to the end of the file:</p>
<pre><code>    console.log(&#39;Car age: &#39; + car1.howOld()) </code></pre>
<p>The log statement should display ‘Car age: 5’.</p>
<hr>

            </div>
          
            <div  class="ui tab segment lab" data-tab="03">
              <h2>ES6/ES2015.</h2>
<p><a href="./javascript-lab_files/es6.zip">This archive</a> contains the sample ES6-compliant JavaScript code discussed in the lecture. Unzip it, in the terminal window go to its base folder (es6samples) and type the command:</p>
<pre><code class="lang-bash">   $ npm install</code></pre>
<p>This will download the babel libraries required transcode and run your ES6 scripts from the Command Line Interface(CLI); it may take some time.
To configure babel to transcode to ES6, create a new file called <strong>.babelrc</strong> in the <em>es6samples</em>  folder and enter the following:</p>
<pre><code class="lang-bash">{
  &quot;presets&quot;: [&quot;env&quot;]
}</code></pre>
<p>This will transpile ES6+ scripts down to ES5 using the <strong>babel-presets-env</strong> module.</p>
<p>We will cover the npm tool later in the semester. Assuming their are no errors, you can now execute any of the samples with the command:</p>
<pre><code class="lang-bash">     $ npm run babel-node [sample file name]</code></pre>
<p>(e.g.  <code>npm run babel-node 02_es6_templates.js</code>)
This command can be quite slow the first time, so be patient.</p>
<p>Unzip this archive and copy the file <strong>Car.js</strong> into the <em>es6samples</em> folder. <strong>Car.js</strong> contains the definition for a custom class, Car - study the code. Now create a new file in <em>es6samples</em>, called <strong>useCar.js</strong> and paste in this code:</p>
<pre><code class="lang-bash">    import Car from &#39;./car.js&#39; ;

    let car1 = new Car(&#39;Joe Bloggs&#39;,&#39;3 Walkers Lane&#39;,
                       &#39;Toyota&#39;,&#39;Corolla&#39;,1.8,&#39;10-WD-1058&#39;);
    car1.addPreviousOwner( &#39;Pat Smith&#39;, &#39;1 Main Street&#39;);
    car1.addPreviousOwner( &#39;Pat Smith&#39;, &#39;1 Main Street&#39;);
    car1.addPreviousOwner( &#39;Sheila Dwyer&#39;, &#39;2 High Street&#39;);
    console.log(`Path Smith ? ${car1.wasOwnedBy(&#39;Pat Smith&#39;)}`);

    car1.newOwner(&#39;Donal Dunne&#39;,&#39;5 Kings Way&#39;);
    console.log(car1.previous_owners[2].name);
    console.log(car1.owner);
    console.log(`Car age: ${car1.howOld()}`);</code></pre>
<p>Run the script:</p>
<pre><code class="lang-bash">   $ npm run babel-node useCar.js</code></pre>
<p>The Car class is missing the features aspect, e.g. Alarm, Parking assist. You are required to examine <strong>functions.js</strong> to review how it was implemented and then update the Car class definition to accommodate it. To prove your code works, add the following to the end of <strong>useCar.js</strong>:</p>
<pre><code class="lang-bash">  console.log(`Alarm: ${aCar.hasFeature(&#39;alarm&#39;)}` );</code></pre>
<p>and run it.</p>

            </div>
          
        </div>
      </div>
    </div>

    <script>
      $(document).on('keydown', function(e) {
  e = e || window.event;
  var nextTab;
  switch (e.which || e.keyCode) {
    case 37: // left
      nextTab = $('.tab-menu a[data-tab].active').prev('a[data-tab]');
      if (!nextTab.length) nextTab = $('.tab-menu a[data-tab]').last();
      nextTab.click();
      $('.pusher').focus();
      break;

    case 39: // right
      nextTab = $('.tab-menu a[data-tab].active').next('a[data-tab]');
      if (!nextTab.length) nextTab = $('.tab-menu a[data-tab]').first();
      nextTab.click();
      $('.pusher').focus();
      break;
  }
});

      $(document).ready(function() {
  $('img').addClass('ui image');

  $('.ui.embed').embed();

  const $images = $('.lab img');
  jQuery.each($images, function(i) {
    if ($images[i].alt.length > 0) {
      const divImg = $(document.createElement('div')).addClass(
        'ui basic segment',
      );
      $($images[i]).wrap(divImg);
      const divLabel = $(document.createElement('div')).addClass(
        'ui blue ribbon label',
      );
      divLabel.append($images[i].alt);
      $(divLabel).insertBefore($images[i]);
    }
  });

  $('.ui.menu .item').tab({
    history: true,
    historyType: 'hash',
  });

  $('.popup').popup();

  $('.ui.sidebar')
    .sidebar({ context: $('.pushable') })
    .sidebar('setting', 'transition', 'slide out')
    .sidebar('attach events', '#toc');
});

    </script>
  </body>
</html>